# Logic App Analysis: cosi-member-adobe-dev-logic

**Resource Group**: cosi-member-adobe-0073.i001-dev-rg  
**Location**: Sweden Central  
**State**: Enabled  
**Created**: 2025-01-22  
**Last Modified**: 2025-01-22

---

## Overview

This Logic App is triggered via HTTP and reads customer export files from an SFTP server, processing XML content.

---

## Trigger

| Type               | Details                |
| ------------------ | ---------------------- |
| **Trigger Type**   | HTTP Request           |
| **Authentication** | ‚ö†Ô∏è **NONE** (Open URL) |
| **URL**            | Generated by Azure     |

**üî¥ SECURITY ALERT**: This workflow uses an HTTP trigger with NO authentication. Anyone with the URL can invoke this workflow!

---

## Actions

| #     | Action Name             | Type               | Description                           |
| ----- | ----------------------- | ------------------ | ------------------------------------- |
| 1     | List_files_in_folder    | SFTP - List Files  | Lists files in /customerExport folder |
| 2     | For_each                | For Each Loop      | Iterates over files                   |
| 2.1   | Check_if_item_is_folder | Condition          | Checks if item is not a folder        |
| 2.1.1 | Get_file_content        | SFTP - Get Content | Gets file content                     |
| 2.1.2 | Compose                 | Data Operations    | Strips XML declaration and root tags  |

---

## Connectors Used

| Connector     | Type                 | Authentication                     |
| ------------- | -------------------- | ---------------------------------- |
| SFTP with SSH | External (Non-Azure) | Username/Password (API Connection) |

---

## Error Handling Analysis

| Pattern                       | Present?   | Details                                   |
| ----------------------------- | ---------- | ----------------------------------------- |
| Scope with Try-Catch          | ‚ùå No      | No scopes defined                         |
| runAfter with Failed/TimedOut | ‚ùå No      | Only "Succeeded" runAfter conditions      |
| Terminate action              | ‚ùå No      | No explicit termination paths             |
| Retry Policies                | ‚ùå No      | Using default policies                    |
| Condition Branch              | ‚ö†Ô∏è Partial | Empty else branch (no action for folders) |

**‚ö†Ô∏è Risk**: SFTP connections are notoriously unreliable. Network issues will cause failures with no retry logic.

---

## Dependencies

| Dependency Type | Resource    | Details              |
| --------------- | ----------- | -------------------- |
| SFTP Server     | External    | /customerExport path |
| API Connection  | sftpwithssh | Stored credentials   |

---

## Authentication Analysis

| Component       | Method                | Secure?                                      |
| --------------- | --------------------- | -------------------------------------------- |
| HTTP Trigger    | **No Authentication** | üî¥ **HIGH RISK**                             |
| SFTP Connection | Username/Password     | ‚ö†Ô∏è Medium (credentials stored in connection) |

---

## Data Flow

```
HTTP Request (No Auth)
         ‚Üì
   [List SFTP Files: /customerExport]
         ‚Üì
   [ForEach File]
         ‚Üì
     [If Not Folder]
         ‚Üì
       [Get File Content (XML)]
         ‚Üì
       [Compose: Strip XML tags]
         ‚Üì
       [??? No Output Action ???]
```

**‚ö†Ô∏è Issue**: The workflow reads and transforms data but does NOT appear to output anything! The Compose action is the last step with no subsequent action.

---

## Potential Issues

1. **Incomplete Workflow**: Data is read and transformed but not sent anywhere
2. **No HTTP Response**: HTTP-triggered workflows should return a response
3. **Open Endpoint**: Anyone with the URL can trigger this workflow

---

## Findings

| Severity | Finding                                        |
| -------- | ---------------------------------------------- |
| **HIGH** | HTTP trigger has NO authentication             |
| **HIGH** | Workflow appears incomplete - no output action |
| MEDIUM   | No error handling for SFTP failures            |
| MEDIUM   | SFTP credentials stored in API Connection      |
| LOW      | No HTTP response action                        |

---

## Recommendations

1. **CRITICAL**: Add authentication to HTTP trigger (SAS key at minimum, OAuth preferred)
2. **CRITICAL**: Complete the workflow - add output action (HTTP response, send to queue, etc.)
3. Add error handling with retry policies for SFTP actions
4. Consider using Key Vault for SFTP credentials

---

_Analyzed: 2026-02-12_
